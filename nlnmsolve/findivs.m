function [z0f] = findivs(func,z0g,nfg,dt)% [z0] = findivs(func,ivg,nfg,dti,dtmin) finds the proper % initial values for the system described by the function func % such that the system moves in a nonlinear normal mode.% %   INPUTS:  z0g   : vector of initial state values.  See rk4_1.%            nfg   : natural frequency guess (rad/sec).  Try the%                    closest linear natural frequency.)%            dt    : time step for spline of result%            func  : name of state equation function%            % Version 1.1% J. C. Slater 1/94% Copyright (c) 1994 by J. C. Slater% All Rights Reserved.% Modified 3/8/94tf=2*pi/nfg;z0=[tf;z0g(4:2:length(z0g))];z0;z0g;func;z0g;%z0f=fminu('evalcost',z0,z0g(1:2),func,dtmin,dtmax)vlb=.6.^sign(z0).*z0;% Lower bound for cycle time and statesvub=1.4.^sign(z0).*z0;% Upper bound for cycle time and statesz0;options(1)=1;%display ouput during optimizationoptions(3)=2e-10;%precisionoptions(14)=400;%max iterationsoptions(17)=1e-9;%max perturbation[z0f,iterations]=constr('evalcost',z0,options,vlb,vub,[ ],dt,z0g,func)iterations(10)